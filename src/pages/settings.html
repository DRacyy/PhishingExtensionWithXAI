<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShieldScan - Settings</title>
    <link rel="stylesheet" href="../../style.css">
    <!-- Lucide Icons CDN -->
    <script src="../utils/lucide.js"></script>
</head>
<body class="light"> <!-- Added class for theme -->
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-container">
                <div class="header-content">
                    <div class="logo-section">
                        <div class="logo-wrapper">
                            <img src="../../assets/images/icon48.png" alt="ShieldScan Logo" class="logo">
            <span class="logo-text">ShieldScan</span>
        </div>
                    </div>

                    <div class="header-actions">
                        <button class="nav-button active" data-tab="settings">Settings</button>
                        <a href="history.html" class="nav-button" data-tab="history">History</a>
                        <button class="theme-toggle" id="themeToggle">
                            <i data-lucide="moon"></i>
                        </button>
                    </div>
            </div>
            </div>
        </header>

        <!-- Main Content -->
    <main class="main-content">
            <div id="settings" class="tab-content active"> <!-- Ensure this ID is present for JS -->
                <div class="settings-container">
            <!-- Account Section -->
                    <div class="card" id="accountSection"> <!-- Preserved ID -->
                        <div class="card-header">
                            <div class="section-title">
                                <div class="icon-wrapper purple">
                                    <i data-lucide="user"></i>
                                </div>
                                <div>
                                    <h2 class="title">Account</h2>
                                    <p class="subtitle">Manage your account settings and sync preferences</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                <!-- This div will be shown when user is not logged in -->
                <div id="unauthenticatedContent">
                                <p class="subtitle">Sign in to sync your settings and scan history across devices.</p>
                                <div class="button-group">
                                    <button id="signupBtn" class="button secondary">Signup</button>
                                    <button id="loginBtn" class="button secondary">Login</button>
                    </div>
                </div>
                <!-- This div will be shown when user is logged in -->
                <div id="authenticatedContent" style="display: none;">
                                 <div class="status-badge success">
                                    <div class="badge">
                                        <div class="status-dot"></div>
                                        Signed in
                                    </div>
                                    <span class="email" id="settingsUserEmail">user@example.com</span>
                                </div>
                                <div class="info-grid">
                                    <div class="info-row">
                                        <span class="label">Sync status:</span>
                                        <span class="value success" id="syncStatusText">Data synced across devices</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="label">Last sync:</span>
                                        <span class="value" id="lastSyncTime">Just now</span>
                                    </div>
                    </div>
                    <div class="button-group">
                                    <button id="syncNowBtn" class="button secondary">
                                        <i data-lucide="refresh-cw"></i>
                            Sync Now
                        </button>
                                    <button id="settingsLogoutBtn" class="button danger">
                                        <i data-lucide="log-out"></i>
                            Sign Out
                        </button>
                    </div>
                </div>
                        </div>
                    </div>
            
            <!-- Protection Features -->
                    <div class="card">
                        <div class="card-header">
                             <div class="section-title">
                                <div class="icon-wrapper purple"> <!-- Changed from blue to purple based on new style -->
                                     <i data-lucide="shield"></i>
                                </div>
                                <div>
                                    <h2 class="title">Protection Features</h2>
                                    <p class="subtitle">Configure your security protection settings</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="feature-list">
                <div class="feature-item">
                                    <div class="feature-info">
                                        <div class="icon-wrapper blue"> <!-- Icon for URL Analysis -->
                                            <i data-lucide="link"></i> <!-- Changed icon -->
                    </div>
                                        <div>
                                            <h3 class="feature-title">URL Analysis</h3>
                        <p class="feature-description">Check URLs against phishing databases</p>
                    </div>
                                    </div>
                                    <label class="switch">
                        <input type="checkbox" id="urlAnalysisToggle" checked>
                                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="feature-item">
                                    <div class="feature-info">
                                        <div class="icon-wrapper purple"> <!-- Icon for ML Detection -->
                                            <i data-lucide="brain"></i>
                    </div>
                                        <div>
                                            <h3 class="feature-title">ML Detection</h3>
                        <p class="feature-description">Detect phishing with machine learning</p>
                    </div>
                                    </div>
                                    <label class="switch">
                        <input type="checkbox" id="mlDetectionToggle" checked>
                                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="feature-item">
                                    <div class="feature-info">
                                        <div class="icon-wrapper orange"> <!-- Icon for Notifications -->
                                            <i data-lucide="bell"></i>
                    </div>
                                        <div>
                                            <h3 class="feature-title">Notifications</h3>
                        <p class="feature-description">Get alerts when threats are detected</p>
                    </div>
                                    </div>
                                    <label class="switch">
                        <input type="checkbox" id="notificationsToggle" checked>
                                        <span class="slider"></span>
                    </label>
                </div>
                            </div>
                        </div>
                </div>
                
                    <!-- Behavior Settings -->
                    <div class="card">
                        <div class="card-header">
                            <div class="section-title">
                                <div class="icon-wrapper blue"> <!-- Generic icon for Behavior -->
                                    <i data-lucide="settings-2"></i>
                                </div>
                                <div>
                                    <h2 class="title">Behavior</h2>
                                    <p class="subtitle">Customize how ShieldScan behaves</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" id="autoScanToggle" checked>
                                    <span class="checkmark"></span>
                                    Automatically scan pages when loaded
                                </label>
                                <label class="checkbox-item">
                    <input type="checkbox" id="showCountToggle" checked>
                                    <span class="checkmark"></span>
                                    Show the number of blocked threats on the toolbar icon
                                </label>
                            </div>
                        </div>
                </div>
            
            <!-- Server Options -->
                    <div class="card">
                        <div class="card-header">
                           <div class="section-title">
                                <div class="icon-wrapper green"> <!-- Icon for Server Options -->
                                     <i data-lucide="server"></i>
                                 </div>
                                <div>
                                    <h2 class="title">Server Options</h2>
                                    <p class="subtitle">Configure server connection settings</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="form-group">
                                <label class="form-label" for="serverUrl">Analysis server URL</label>
                                <input type="text" id="serverUrl" class="form-input monospace" value="http://localhost:5000">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="apiKey">
                                    <i data-lucide="key"></i>
                                    API Key (if required)
                                </label>
                                <input type="password" id="apiKey" class="form-input monospace" placeholder="Enter your API key">
                            </div>
                        </div>
                </div>
                
                    <!-- Whitelist -->
                    <div class="card">
                        <div class="card-header">
                            <div class="section-title">
                                <div class="icon-wrapper orange"> <!-- Icon for Whitelist -->
                                    <i data-lucide="list-checks"></i>
                                </div>
                                <div>
                                    <h2 class="title">Whitelist</h2>
                                    <p class="subtitle">List of websites for which no scanning will take place</p>
                                </div>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="form-group">
                                <label class="form-label" for="whitelist">Trusted domains</label>
                                <textarea id="whitelist" class="form-textarea monospace" rows="6" placeholder="Enter domain names, one per line (e.g. example.com)"></textarea>
                                <p class="form-help">Add trusted websites that should be excluded from scanning. Enter one domain per line.</p>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
    </main>
    <!-- Floating Save Changes Popup -->
    <div id="savePopup" class="save-popup fixed bottom-6 right-6 z-50">
        <div class="bg-slate-800/95 backdrop-blur-xl border border-slate-600/50 rounded-full shadow-xl shadow-purple-900/30 px-6 py-3">
            <div class="flex items-center gap-3">
                <button id="newSaveBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-1.5 h-7 rounded-full text-sm flex items-center">
                    <i data-lucide="save" class="w-3 h-3 mr-1.5"></i>
                    Save
                </button>
                <button id="resetBtn" class="text-slate-300 hover:bg-slate-700 hover:text-white px-3 py-1.5 h-7 rounded-full text-sm flex items-center">
                    <i data-lucide="rotate-ccw" class="w-3 h-3 mr-1.5"></i>
                    Reset
                </button>
            </div>
        </div>
    </div>

    <!-- Save Dialog -->
    <div id="dialogOverlay" class="dialog-overlay"></div>
    <div id="saveDialog" class="dialog bg-slate-900 border border-slate-600 text-white rounded-lg shadow-xl w-full max-w-lg">
        <div class="p-6">
            <div class="flex items-center gap-2 text-white mb-2">
                <i data-lucide="save" class="w-4 h-4 text-purple-400"></i>
                <h3 class="text-lg font-semibold">Save Changes</h3>
            </div>
            <p class="text-slate-200 text-sm mb-4">
                Are you sure you want to save these changes? This will update your security settings and sync across all devices.
            </p>

            <div class="py-4">
                <div id="changesContainer" class="bg-slate-800/80 border border-slate-600/50 rounded-lg p-4 space-y-2 max-h-60 overflow-y-auto">
                    <div class="text-sm font-medium text-slate-200 mb-2">Changes to be saved:</div>
                    <!-- Changes will be inserted here dynamically -->
                </div>
            </div>

            <div class="flex justify-end gap-2 mt-4">
                <button id="discardBtn" class="border border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-white px-3 py-1.5 h-8 rounded-md text-sm">
                    Discard
                </button>
                <button id="confirmSaveBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-1.5 h-8 rounded-md text-sm flex items-center">
                    <i data-lucide="check" class="w-3 h-3 mr-1.5"></i>
                    Save
                </button>
            </div>
        </div>
    </div>
    </div>

    <script src="settings.js"></script>
</body>
</html>